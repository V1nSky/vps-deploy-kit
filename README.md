# üöÄ vps-deploy-kit

–ì–æ—Ç–æ–≤—ã–π CI/CD pipeline –¥–ª—è –∞–≤—Ç–æ–¥–µ–ø–ª–æ—è Node.js –∏ Python –ø—Ä–æ–µ–∫—Ç–æ–≤ –Ω–∞ VPS —á–µ—Ä–µ–∑ GitHub Actions.

**–û—Ç –Ω—É–ª—è –¥–æ —Ä–∞–±–æ—á–µ–≥–æ –∞–≤—Ç–æ–¥–µ–ø–ª–æ—è ‚Äî –º–µ–Ω—å—à–µ 15 –º–∏–Ω—É—Ç.**

```
GitHub push  ‚Üí  GitHub Actions (—Å–±–æ—Ä–∫–∞ + –¥–µ–ø–ª–æ–π)  ‚Üí  VPS / Docker
                                                          ‚îÇ
                                       Telegram Bot  ‚Üê‚îÄ‚îÄ‚îÄ‚îò
```

---

## ‚ú® –ß—Ç–æ —É–º–µ–µ—Ç

| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| üîÑ –ê–≤—Ç–æ–¥–µ–ø–ª–æ–π | Push –≤ `main` ‚Üí –¥–µ–ø–ª–æ–π –Ω–∞ –ø—Ä–æ–¥. Push –≤ `develop` ‚Üí staging |
| üê≥ Docker | Multi-stage build, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ—ë–≤ |
| ‚ù§Ô∏è Health-check | –ü—Ä–æ–≤–µ—Ä–∫–∞ HTTP 200 –ø–µ—Ä–µ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ–º –¥–µ–ø–ª–æ—è |
| üîô Rollback | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–∫–∞—Ç –µ—Å–ª–∏ health-check –ø—Ä–æ–≤–∞–ª–∏–ª—Å—è |
| üì© Telegram | –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: —É—Å–ø–µ—Ö, –æ—à–∏–±–∫–∞, –æ—Ç–∫–∞—Ç |
| üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | SSH-–∫–ª—é—á–∏, –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, Fail2ban, UFW |
| üåç –û–∫—Ä—É–∂–µ–Ω–∏—è | Staging (–∞–≤—Ç–æ) + Production (—Ä—É—á–Ω–æ–π –∞–ø–ø—Ä—É–≤) |

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- VPS —Å Ubuntu 20.04+ (–º–∏–Ω–∏–º—É–º 1 GB RAM, 20 GB SSD)
- GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- Telegram Bot (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π)

---

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å workflow –≤ —Å–≤–æ–π –ø—Ä–æ–µ–∫—Ç

**–î–ª—è Node.js:**
```bash
mkdir -p .github/workflows
curl -o .github/workflows/deploy.yml \
  https://raw.githubusercontent.com/V1nSky/vps-deploy-kit/main/.github/workflows/nodejs-deploy.yml
```

**–î–ª—è Python:**
```bash
mkdir -p .github/workflows
curl -o .github/workflows/deploy.yml \
  https://raw.githubusercontent.com/V1nSky/vps-deploy-kit/main/.github/workflows/python-deploy.yml
```

### 2. –î–æ–±–∞–≤–∏—Ç—å Dockerfile

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≥–æ—Ç–æ–≤—ã–π `Dockerfile` –∏–∑ `examples/nodejs-project/` –∏–ª–∏ `examples/python-project/`.

**–ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ:** –≤ –≤–∞—à–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `/health` —ç–Ω–¥–ø–æ–∏–Ω—Ç, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π HTTP 200.

### 3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å VPS

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ VPS –æ—Ç root
ssh root@–í–ê–®_IP

# –°–∫–∞—á–∞–π—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
curl -o setup.sh https://raw.githubusercontent.com/V1nSky/vps-deploy-kit/main/scripts/setup-server.sh
bash setup.sh
```

–°–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç: Docker, Nginx, Certbot, Fail2ban, UFW –∏ —Å–æ–∑–¥–∞—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `deployer`.

### 4. –î–æ–±–∞–≤–∏—Ç—å SSH-–∫–ª—é—á –¥–µ–ø–ª–æ–µ—Ä–∞

```bash
# –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ ‚Äî —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –∫–ª—é—á
ssh-keygen -t ed25519 -C "github-actions-deploy" -f ~/.ssh/deploy_key

# –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á ‚Üí –Ω–∞ VPS
cat ~/.ssh/deploy_key.pub
# –í—Å—Ç–∞–≤—å—Ç–µ –≤ /home/deployer/.ssh/authorized_keys –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
```

### 5. –î–æ–±–∞–≤–∏—Ç—å GitHub Secrets

–ü–µ—Ä–µ–π–¥–∏—Ç–µ: `Settings ‚Üí Secrets and variables ‚Üí Actions ‚Üí New repository secret`

| Secret | –ó–Ω–∞—á–µ–Ω–∏–µ |
|--------|----------|
| `VPS_HOST` | IP –∏–ª–∏ –¥–æ–º–µ–Ω –≤–∞—à–µ–≥–æ VPS |
| `VPS_USER` | `deployer` |
| `VPS_SSH_KEY` | –°–æ–¥–µ—Ä–∂–∏–º–æ–µ `~/.ssh/deploy_key` (–ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á) |
| `TELEGRAM_BOT_TOKEN` | –¢–æ–∫–µ–Ω –æ—Ç @BotFather (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |
| `TELEGRAM_CHAT_ID` | –í–∞—à chat ID (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |
| `PROD_URL` | https://–≤–∞—à-–¥–æ–º–µ–Ω.ru |
| `STAGING_URL` | https://staging.–≤–∞—à-–¥–æ–º–µ–Ω.ru |

### 6. –ü—É—à–∏—Ç—å ‚Äî –¥–µ–ø–ª–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π!

```bash
git add .
git commit -m "feat: add auto-deploy"
git push origin main
```

–û—Ç–∫—Ä–æ–π—Ç–µ –≤–∫–ª–∞–¥–∫—É **Actions** –≤ GitHub ‚Äî —É–≤–∏–¥–∏—Ç–µ –∂–∏–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è üéâ

---

## üåç –û–∫—Ä—É–∂–µ–Ω–∏—è: Staging –∏ Production

```
develop branch  ‚Üí  staging.your-app.ru   (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
main branch     ‚Üí  your-app.ru           (–Ω—É–∂–µ–Ω —Ä—É—á–Ω–æ–π –∞–ø–ø—Ä—É–≤)
```

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –≤ GitHub: `Settings ‚Üí Environments ‚Üí production` ‚Üí –¥–æ–±–∞–≤—å—Ç–µ Required reviewers.

---

## üîô –†—É—á–Ω–æ–π –æ—Ç–∫–∞—Ç

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫ ‚Äî –æ—Ç–∫–∞—Ç–∏—Ç–µ—Å—å –≤ –æ–¥–∏–Ω –∫–ª–∏–∫:

`Actions ‚Üí üîô Manual Rollback ‚Üí Run workflow ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä`

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```
vps-deploy-kit/
‚îú‚îÄ‚îÄ .github/workflows/
‚îÇ   ‚îú‚îÄ‚îÄ nodejs-deploy.yml      # Workflow –¥–ª—è Node.js
‚îÇ   ‚îú‚îÄ‚îÄ python-deploy.yml      # Workflow –¥–ª—è Python
‚îÇ   ‚îî‚îÄ‚îÄ rollback.yml           # –†—É—á–Ω–æ–π –æ—Ç–∫–∞—Ç
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ setup-server.sh        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ VPS (–∑–∞–ø—É—Å—Ç–∏—Ç—å 1 —Ä–∞–∑)
‚îÇ   ‚îú‚îÄ‚îÄ deploy.sh              # –°–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è
‚îÇ   ‚îú‚îÄ‚îÄ health-check.sh        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
‚îÇ   ‚îî‚îÄ‚îÄ rollback.sh            # –û—Ç–∫–∞—Ç
‚îú‚îÄ‚îÄ configs/
‚îÇ   ‚îú‚îÄ‚îÄ nginx-node.conf        # –®–∞–±–ª–æ–Ω nginx –¥–ª—è Node.js
‚îÇ   ‚îú‚îÄ‚îÄ nginx-python.conf      # –®–∞–±–ª–æ–Ω nginx –¥–ª—è Python
‚îÇ   ‚îî‚îÄ‚îÄ docker-compose.template.yml
‚îú‚îÄ‚îÄ examples/
‚îÇ   ‚îú‚îÄ‚îÄ nodejs-project/        # Express + Dockerfile
‚îÇ   ‚îî‚îÄ‚îÄ python-project/        # FastAPI + Dockerfile
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ SETUP.md                   # –ü–æ–ª–Ω–∞—è –ø–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
‚îî‚îÄ‚îÄ LICENSE
```

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- SSH-–¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –ø–æ –∫–ª—é—á–∞–º, –±–µ–∑ –ø–∞—Ä–æ–ª–µ–π
- –û—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `deployer` –±–µ–∑ sudo
- –í—Å–µ —Å–µ–∫—Ä–µ—Ç—ã ‚Äî –≤ GitHub Secrets, –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤ –∫–æ–¥–µ
- Docker-–∏–∑–æ–ª—è—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- UFW: –∑–∞–∫—Ä—ã—Ç—ã –≤—Å–µ –ø–æ—Ä—Ç—ã –∫—Ä–æ–º–µ SSH, 80, 443
- Fail2ban: –∑–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞

---

## üìä –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –¶–µ–ª—å | –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç |
|---------|------|-------------|
| –í—Ä–µ–º—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ | < 15 –º–∏–Ω—É—Ç | –û–¥–∏–Ω —Å–∫—Ä–∏–ø—Ç `setup-server.sh` |
| –í—Ä–µ–º—è –¥–µ–ø–ª–æ—è | < 2 –º–∏–Ω—É—Ç | Docker –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ—ë–≤ |
| –£—Å–ø–µ—à–Ω–æ—Å—Ç—å –¥–µ–ø–ª–æ–µ–≤ | > 95% | Health-check + –∞–≤—Ç–æ–æ—Ç–∫–∞—Ç |
| –í—Ä–µ–º—è –æ—Ç–∫–∞—Ç–∞ | < 30 —Å–µ–∫—É–Ω–¥ | –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π –æ–±—Ä–∞–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ |

---

## üêõ Troubleshooting

**–î–µ–ø–ª–æ–π –ø–∞–¥–∞–µ—Ç –Ω–∞ SSH:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–ª—é—á –¥–æ–±–∞–≤–ª–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
ssh -i ~/.ssh/deploy_key deployer@–í–ê–®_IP
```

**Health-check –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ /health –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 200
curl http://localhost:3000/health
# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker logs app-nodejs
```

**–ù–µ—Ç Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:**
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –±–æ—Ç –Ω–∞–ø–∏—Å–∞–ª –≤–∞–º –ø–µ—Ä–≤—ã–º (–∏–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –≥—Ä—É–ø–ø—É)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å `TELEGRAM_CHAT_ID` —á–µ—Ä–µ–∑ `@userinfobot`

**–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç:**
```bash
docker ps -a                    # –í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker logs app-nodejs          # –õ–æ–≥–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–ø—É—Å–∫–∞
docker inspect app-nodejs       # –î–µ—Ç–∞–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
```

---

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã

- [url-shortener](https://github.com/V1nSky/url-shortener) ‚Äî –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –¥–µ–ø–ª–æ—è
- [telegram-bot-template](https://github.com/V1nSky/telegram-bot-template) ‚Äî —à–∞–±–ª–æ–Ω Telegram –±–æ—Ç–∞

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ, –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–π—Ç–µ, —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–π—Ç–µ —Å–≤–æ–±–æ–¥–Ω–æ.

---

*V1nSky / vps-deploy-kit ¬∑ MIT License ¬∑ 2026*
